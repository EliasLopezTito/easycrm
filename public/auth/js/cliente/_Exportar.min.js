$(function () { let t = $(".modal-footer > button"); var a = $("#export_estado_id"), o = $("#export_vendedor_id"), e = $("#export_modalidad_id"), n = $("#export_carrera_id"), r = $("#export_turno_id"), d = $("#export_fecha_inicio"), s = $("#export_fecha_final"); e.change(function () { n.html("").append('<option value="">-- Todos --</option>'), 0 != $(this).val() && actionAjax("/curso/filtroCurso/" + $(this).val(), null, "GET", function (t) { $.each(t, function (t, a) { n.append(`<option value="${a.id}">${a.name}</option>`) }) }) }), moment.locale("es"); var c = parseInt(moment().format("D")) >= 16 ? moment().startOf("month").add(15, "days") : moment().subtract(1, "month").startOf("month").add(15, "days"), l = parseInt(moment().format("D")) >= 16 ? moment().endOf("month").add(15, "days") : moment().subtract(1, "month").endOf("month").add(15, "days"); function i(t, a) { $("#export_reportrange span").html(t.format("MMMM D, YYYY") + " - " + a.format("MMMM D, YYYY")) } $("#export_reportrange").daterangepicker({ autoUpdateInput: !1, startDate: c, endDate: l, ranges: { Todos: [moment(new Date("2018-01-01")), moment()], Hoy: [moment(), moment()], Ayer: [moment().subtract(1, "days"), moment().subtract(1, "days")], "\xdaltimos 7 d\xedas": [moment().subtract(6, "days"), moment()], "\xdaltimos 30 d\xedas": [moment().subtract(29, "days"), moment()], "Esta Campa\xf1a": [parseInt(moment().format("D")) >= 16 ? moment().startOf("month").add(15, "days") : moment().subtract(1, "month").startOf("month").add(15, "days"), parseInt(moment().format("D")) >= 16 ? moment().endOf("month").add(15, "days") : moment().subtract(1, "month").endOf("month").add(15, "days")], "Este Mes": [moment().startOf("month"), moment().endOf("month")], "Mes Anterior": [moment().subtract(1, "month").startOf("month"), moment().subtract(1, "month").endOf("month")], "Todo el A\xf1o": [moment().subtract(1, "month").startOf("year"), moment().subtract(1, "month").endOf("year")] } }, i), i(c, l), t.click(function () { d.val(moment($("#export_reportrange").data("daterangepicker").startDate._d).format("YYYY-MM-DD")), s.val(moment($("#export_reportrange").data("daterangepicker").endDate._d).format("YYYY-MM-DD")); let t = "" != a.val() ? a.val() : 0, c = "" != o.val() ? o.val() : 0, l = "" != e.val() ? e.val() : 0, i = "" != n.val() ? n.val() : 0, m = "" != r.val() ? r.val() : 0; actionAjax("/cliente/exportExcel/" + d.val().replace(/\//g, "-") + "/" + s.val().replace(/\//g, "-") + "/" + t + "/" + c + "/" + l + "/" + i + "/" + m, null, "GET", function (t) { $.each(t, function (t, a) { swal("Bien!", "Exportaci\xf3n de leads realizada con \xe9xito, en unos minutos encontrar\xe1 el link de descarga en sus notificaciones.", "success") }) }) }) });